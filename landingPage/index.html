<!DOCTYPE html>
<html lang="en">
<head>
  <title>FurQuest</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-database.js"></script>
  <link rel="stylesheet" href="homeStyles.css">
</head>
<body>

  <div class="dropdown accountIcon">
    <button class="btn  dropdown-toggle" type="button" data-toggle="dropdown" style="background-color:white">
    <img src="../assets/accountIcon.png" width="60em" height="60em" alt="submit" onmouseover="chgImg(this)" onmouseout="chgImgBack(this)"/></button>
    <ul class="dropdown-menu">
	  <li><a href="#"  id="logOutMenu">Log Out</a></li>
      <li><a href="#" data-toggle="modal" data-target="#loginModal" id="logInMenu">Log In</a></li>
      <li><a href="#" data-toggle="modal" data-target="#createAccModal" id="createAccMenu">Create an account</a></li>
    </ul>
  </div>
  <p id="username" style="font-size:14px; padding-left:1em; color:white"> </p>

<h2 class="title">FurQuest</h2>  

<div class="modal" id="createAccModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title title">Create An Account</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <label for="email" class="modalText">Enter your email:</label>
		<input type="email" id="emailCreate" name="email">
		
		<label for="password1" class="modalText">Enter your password:</label>
		<input type="password" id="passwordCreate" name="password1">
		
		<label for="password2" class="modalText">Enter your password again:</label>
		<input type="password" id="password2" name="password2">
      </div>
	  
	  <div class="modal-footer">
        <button type="button" class="btn btn-primary"  id="btnSignUp">Create Account</button>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal" id="btnCloseSignUp">Close</button>
      </div>
	  
    </div>
  </div>
</div>

<div class="modal" id="loginModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title title">Log In</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <label for="email" class="modalText">Enter your email:</label>
		<input type="email" id="emailLogin" name="email">
		
		<label for="password1" class="modalText">Enter your password:</label>
		<input type="password" id="passwordLogin" name="password1">

      </div>
	  
	  <div class="modal-footer">
        <button type="button" class="btn btn-primary"  id="btnLogIn">Log In</button>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal" id="btnCloseLogIn">Close</button>
      </div>

    </div>
  </div>
</div>


    <div style="float:center">
		<p class="aboutText">
		Welcome to FurQuest! FurQuest is a simple & lightweight mmorpg. Create a character, and explore the vast
		world of FurQuest alongside others. Play minigames, go shopping, or depart on challenging adventures
		with your friends!</p>
	</div> 



<div class="container" style="float:left; height:45%; width:45%; padding-left: 4em">
  <div class="card">
    
	
	  
        <div id="myCarousel" class="carousel slide" data-ride="carousel">
			<!-- Indicators -->
			<ol class="carousel-indicators">
			  <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
			  <li data-target="#myCarousel" data-slide-to="1"></li>
			  <li data-target="#myCarousel" data-slide-to="2"></li>
			</ol>

			<!-- Wrapper for slides -->
			<div class="carousel-inner">
			  <div class="item active">
				<img src="../assets/woodChair.png" alt="Los Angeles" style="width:100%;">
			  </div>

			  <div class="item">
				<img src="../assets/library.png" alt="Chicago" style="height:100%;">
			  </div>
			
			  <div class="item">
				<img src="../assets/vendingMachineSnack.png" alt="New york" style="height:100%;">
			  </div>
			</div>

			<!-- Left and right controls -->
			<a class="left carousel-control" href="#myCarousel" data-slide="prev">
			  <span class="glyphicon glyphicon-chevron-left"></span>
			  <span class="sr-only">Previous</span>
			</a>
			<a class="right carousel-control" href="#myCarousel" data-slide="next">
			  <span class="glyphicon glyphicon-chevron-right"></span>
			  <span class="sr-only">Next</span>
			</a>
		  </div>
		
		

  </div>
</div>

<a href="#" target="_self">
  <img src="../assets/play3.png" style="float:up; width:20%; height:30%; background-color: white" id="btnPlay" onmouseover="chgImgPlay(this)" onmouseout="chgImgPlayBack(this)">
</a>



</body>

<script>
function chgImg(x){
  x.src = "../assets/accountIconPressed.jpg"
}
function chgImgBack(x) {
  x.src = "../assets/accountIcon.png"
}
function chgImgPlay(x){
  x.src = "../assets/play4.png"
}
function chgImgPlayBack(x){
  x.src = "../assets/play3.png"
}

var btnSignUp = document.getElementById('btnSignUp');
var btnLogIn = document.getElementById('btnLogIn');

const createAcc = document.getElementById('createAccMenu');
const LogInMenu = document.getElementById('logInMenu');
const logOutMenu = document.getElementById('logOutMenu');
const username = document.getElementById('username');
const btnCloseLogin = document.getElementById('btnCloseLogIn');
const btnCloseSignUp = document.getElementById('btnCloseSignUp')
const btnPlay = document.getElementById('btnPlay');

var isLoggedIn = false;
var isVerrified = false;

btnSignUp.addEventListener('click', e => { 
  const email = document.getElementById('emailCreate').value;
  const pass1 = document.getElementById('passwordCreate').value;
  const pass2 = document.getElementById('password2').value;
  if(pass1 != pass2){
    alert('passwords do not match'); 
	return;
  }  
  
  const auth = firebase.auth();
  const promise = auth.createUserWithEmailAndPassword(email, pass1);
  promise.then(btnCloseSignUp.click()).catch(e => alert(e.message));
  
})

btnLogIn.addEventListener('click', e => { 
  const email = document.getElementById('emailLogin').value;
  const pass1 = document.getElementById('passwordLogin').value;
  const pass2 = document.getElementById('password2').value;
  
  const auth = firebase.auth();
  const promise = auth.signInWithEmailAndPassword(email, pass1);
  promise.then(btnCloseLogIn.click()).catch(e => alert(e.message));
  
})

logOutMenu.addEventListener('click', e => {
    firebase.auth().signOut().then(function() {
	  alert("log out successful")
    }, function(error) {
      alert(error.message)
    });
})

btnPlay.addEventListener('click', e => {
  if(isLoggedIn == false) {alert("please log in first"); return}
  //if(isVerrified == false) {alert("please verify your email first"); return}
  window.location.href = "./charactersPage.html"
})

function promptEmailVerification(firebaseUser){
alert("please verify your email by clicking on the link sent to it")
firebaseUser.sendEmailVerification().catch( e => console.log(e.message))
}


// Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyDGPX41BsvlB0a05akJiWTS_9yH_UZO744",
    authDomain: "furquest-1c939.firebaseapp.com",
    databaseURL: "https://furquest-1c939.firebaseio.com",
    projectId: "furquest-1c939",
    storageBucket: "furquest-1c939.appspot.com",
    messagingSenderId: "178770843812",
    appId: "1:178770843812:web:f8bf303167b573f41c6e31",
    measurementId: "G-D1DXBJLC06"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
  
  const dbRefObj = firebase.database().ref().child('object');
  dbRefObj.on('value', snap => console.log(snap.val() ));
  
  firebase.auth().onAuthStateChanged(firebaseUser => {
  if(firebaseUser){
    console.log(firebaseUser);
	isLoggedIn = true;
	isVerrified = firebaseUser.emailVerified;
	createAccMenu.style.visibility = "hidden"
	logInMenu.style.visibility = "hidden"
	logOutMenu.style.visibility = "visible"
	username.innerText = firebaseUser.email
	if(firebaseUser.emailVerified == false) promptEmailVerification(firebaseUser)
  }
  else{
    console.log("not logged in");
	isLoggedIn = false;
	isVerrified = false;
	createAccMenu.style.visibility = "visible"
	logInMenu.style.visibility = "visible"
	logOutMenu.style.visibility = "hidden"
	username.innerText = "not logged in"
  }
})

</script>

</html>
